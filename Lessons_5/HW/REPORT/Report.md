#  Стандартные аугментации torchvision(Задание1)
## Ход работы
- Создан пайплайн аугментаций с использованием torchvision.transforms, включающий:
- - RandomHorizontalFlip: Горизонтальное отражение с вероятностью 1.0 (отдельно) и 0.5 (в комбинации).
- - RandomCrop: Случайное обрезание до 200x200 с отступом 20 пикселей.
- - ColorJitter: Изменение яркости, контраста, насыщенности и оттенка (значения 0.5 и 0.1 соответственно для отдельных, 0.3 и 0.1 для комбинации).
- - RandomRotation: Случайный поворот на ±30° (отдельно) и ±25° (в комбинации).
- - RandomGrayscale: Преобразование в градации серого с вероятностью 0.3 (отдельно) и 0.2 (в комбинации).
- Было выбрано по одному изображению из 5 разных классов

## Визуализация результатов
![Image alt](https://github.com/ecocoo/ML_summer_Prac/blob/main/Lessons_5/HW/REPORT/images/image.png)
![Image alt](https://github.com/ecocoo/ML_summer_Prac/blob/main/Lessons_5/HW/REPORT/images/image-1.png)
![Image alt](https://github.com/ecocoo/ML_summer_Prac/blob/main/Lessons_5/HW/REPORT/images/image-2.png)
![Image alt](https://github.com/ecocoo/ML_summer_Prac/blob/main/Lessons_5/HW/REPORT/images/image-3.png)
![Image alt](https://github.com/ecocoo/ML_summer_Prac/blob/main/Lessons_5/HW/REPORT/images/image-4.png)
![Image alt](https://github.com/ecocoo/ML_summer_Prac/blob/main/Lessons_5/HW/REPORT/images/image-5.png)


#  Кастомные аугментации(Задание2)
## Ход работы
### Реализация кастомных аугментаций
- RandomBlur: Применяет размытие с радиусом от 2.0 до 5.0 с вероятностью 1.0
- RandomPerspective: Выполняет перспективную трансформацию с масштабом искажения 0.3 и вероятностью 1.0, изменяя углы обзора 
- RandomBrightnessContrast: Регулирует яркость (±0.5) и контраст (±0.5) с вероятностью 1.0, усиливая или ослабляя детали

### Готовые аугментации
- Solarize: Инвертирует цвета ниже порога 128
- ElasticTransform: Применяет эластичную деформацию
- AutoContrast: Автоматически корректирует контраст

## Визуализация результатов
![Image alt](https://github.com/ecocoo/ML_summer_Prac/blob/main/Lessons_5/HW/REPORT/images/image-6.png)


#  Анализ датасета(Задание3)
## Количество изображений по классам
- Количество изображений по классам
- Гароу: 30 изображений
- Генос: 30 изображений
- Сайтама: 30 изображений
- Соник: 30 изображений
- Татсумаки: 30 изображений
- Фубуки: 30 изображений
- Все классы имеют равное количество изображений (по 30), что указывает на сбалансированность датасета.

## Статистика размеров изображений
- Минимальный размер: (210, 240) пикселей
- Максимальный размер: (736, 1308) пикселей
- Средний размер: (538.89, 623.56) пикселей


## Визуализация результатов
![Image alt](https://github.com/ecocoo/ML_summer_Prac/blob/main/Lessons_5/HW/REPORT/images/image-7.png)
![Image alt](https://github.com/ecocoo/ML_summer_Prac/blob/main/Lessons_5/HW/REPORT/images/image-8.png)

- Распределение по классам: Гистограмма показывает равномерное распределение количества изображений по шести классам, что подтверждает сбалансированность.
- Распределение ширин: Гистограмма демонстрирует пики около среднего значения (560 пикселей), с разбросом 
- Распределение высот: Гистограмма показывает пики около 600 пикселей

#  Pipeline аугментаций(Задание4)
## Описание класса AugmentationPipeline
- add_augmentation(name, aug): Добавляет аугментацию с указанным именем, сохраняя порядок применения.
- remove_augmentation(name): Удаляет аугментацию по имени, если она существует.
- apply(image): Применяет все аугментации в порядке добавления к изображению.
- get_augmentations(): Возвращает список имен аугментаций в порядке применения.

## Конфигурации аугментаций
- Light - Применяется для минимальной обработки.:
- - RandomHorizontalFlip (p=0.5): Случайное горизонтальное отражение.
- - ToTensor: Преобразование в тензор.
- Medium - Средний уровень:
- - RandomHorizontalFlip (p=0.5): Случайное горизонтальное отражение.
- - RandomCrop (200, padding=20): Случайное обрезание с отступом.
- - ColorJitter (0.2, 0.2, 0.2, 0.1): Легкая регулировка цвета.
- - ToTensor: Преобразование в тензор.
- - AddGaussianNoise (0., 0.1): Добавление шума.
- Heavy - Максимальное разнообразие.:
- RandomHorizontalFlip (p=0.5): Случайное горизонтальное отражение.
- RandomCrop (200, padding=20): Случайное обрезание с отступом.
- ColorJitter (0.4, 0.4, 0.4, 0.2): Сильная регулировка цвета.
- ToTensor: Преобразование в тензор.
- AddGaussianNoise (0., 0.1): Добавление шума.
- CutOut (p=0.5, size=(32, 32)): Случайное вырезание участка.

- **Результаты сохранены в подкаталогах augmented/train/**

#  Эксперимент с размерами(Задание5)
## Ход работы
- Проведены эксперименты с размерами изображений: 64x64, 128x128, 224x224, 512x512. 
- Для каждого размера измерены: 
- - Время обработки 100 изображений (в секундах).
- - Потребление памяти (в мегабайтах).

## Результаты 
- Размер изображения: (64, 64)
- - Время обработки: 0.82 сек
- - Использовано памяти: 40.11 МБ
- Размер изображения: (128, 128)
- - Время обработки: 0.75 сек
- - Использовано памяти: 2.39 МБ
- Размер изображения: (224, 224)
- - Время обработки: 0.89 сек
- - Использовано памяти: 4.12 МБ
- Размер изображения: (512, 512)
- - Время обработки: 1.76 сек
- - Использовано памяти: 16.47 МБ

## Визуализация результатов
![Image alt](https://github.com/ecocoo/ML_summer_Prac/blob/main/Lessons_5/HW/REPORT/images/image-9.png)

- График времени: Кривая с точками показывает рост времени с увеличением размера. Увеличению подтверждает сложность обработки больших изображений.
- График памяти: Кривая демонстрирует резкий спад , затем плавный рост. Если не учитывать резкий спад, то с увеличением размера увеличивается и потребление памяти

#  Дообучение предобученных моделей(Задание6)
## Ход работы
- Использована предобученная модель ResNet18 с весами ImageNet.
- Последний слой заменен на линейный слой с 6 выходами (количество классов датасета: Гароу, Генос, Сайтама, Соник, Татсумаки, Фубуки).
- Модель дообучалась на тренировочном наборе с аугментациями (Resize, ToTensor) и проверялась на тестовом наборе.
- Параметры обучения
- - Количество эпох: 15
- - Размер батча: 32
- - Скорость обучения: 0.001
- - Устройство: MPS
- - Оптимизатор: Adam

## Визуализация результатов
![Image alt](https://github.com/ecocoo/ML_summer_Prac/blob/main/Lessons_5/HW/REPORT/images/image-10.png)

- График Loss: Линии демонстрируют тенденцию к снижению, видно переобучение после 13 эпохи
- График Accuracy: Линии показывают рост,с видимым переобучением после 13 эпохи





